<!DOCTYPE html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Glyphie Chat</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <div id="container">
      <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ MINIMIZED PANEL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
      <div class="minimized-panel">
        <div class="minimized-status" id="minimized-status">Glyphie</div>
        <button class="minimized-expand-btn" id="minimized-expand-btn">
          Expand
        </button>
      </div>

      <div id="wrapper">
        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <nav id="sidebar" role="tablist" aria-label="Main navigation">
          <div class="logo" aria-label="Glyphie logo">Glyphie</div>

          <button class="nav-btn" data-section="home">üè† Home</button>

          <button
            class="nav-btn active"
            data-section="characters"
            title="Characters"
            role="tab"
            aria-selected="true"
            tabindex="0"
          >
            <span aria-hidden="true">üëæ</span>
            <span class="label">Agents</span>
          </button>

          <button
            class="nav-btn"
            data-section="snip"
            title="Snip Tool"
            role="tab"
            aria-selected="false"
            tabindex="-1"
          >
            <span aria-hidden="true">‚úÇÔ∏è</span>
            <span class="label">Snip</span>
          </button>

          <button
            class="nav-btn"
            data-section="settings"
            title="Settings"
            role="tab"
            aria-selected="false"
            tabindex="-1"
          >
            <span aria-hidden="true">‚öôÔ∏è</span>
            <span class="label">Settings</span>
          </button>

          <button
            class="nav-btn"
            data-section="stats"
            title="Usage Stats"
            role="tab"
            aria-selected="false"
            tabindex="-1"
          >
            <span aria-hidden="true">üìä</span>
            <span class="label">Usage</span>
          </button>
        </nav>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ CHARACTERS SECTION (populated by JS) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section
          id="characters-section"
          class="content-section"
          aria-label="Characters"
        ></section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SNIP SECTION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section
          id="snip-section"
          class="content-section hidden"
          aria-label="Snip Tool"
        >
          <div class="chat-panel">
            <div class="chat-header" aria-label="Snip mode header">
              <span>Snip Mode ‚úÇÔ∏è</span>
            </div>

            <!-- THREAD BAR (used by popup.js) -->
            <!-- UPDATED THREAD BAR - Dropdown Style -->
            <div id="snip-thread-bar" class="thread-section">
              <div class="thread-header-dropdown">
                <button
                  id="snip-thread-dropdown-btn"
                  class="thread-dropdown-toggle"
                >
                  <span class="thread-dropdown-icon">üí¨</span>
                  <span class="thread-dropdown-text">Threads</span>
                  <span class="thread-dropdown-arrow">‚ñº</span>
                </button>

                <div class="thread-controls">
                  <button
                    id="refresh-threads-btn"
                    title="Refresh threads"
                    type="button"
                  >
                    üîÑ
                  </button>
                  <button
                    id="snip-new-thread-btn"
                    type="button"
                    title="New Thread"
                  >
                    +
                  </button>
                </div>
              </div>

              <!-- This will be hidden by default -->
              <ul
                id="snip-thread-list"
                class="thread-list thread-dropdown-content"
              ></ul>
            </div>

            <!-- SNIP CHAT HISTORY -->
            <div id="snip-chat-history" class="chat-history"></div>

            <!-- SNIP CHAT INPUT -->
            <div class="chat-input-row">
              <button id="snip-btn" title="Start a new snip" type="button">
                Snip ‚úÇÔ∏è
              </button>
              <input
                id="snip-chat-input"
                type="text"
                placeholder="Add a message (optional)‚Ä¶"
                autocomplete="off"
                aria-label="Add a message (optional)"
              />
              <button id="snip-send-btn" type="button">Send</button>
            </div>
          </div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ STATS SECTION (placeholder) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section id="usage-section" class="hidden">
          <div class="chat-panel">
            <div class="chat-header">
              <span class="chat-name">üìä Usage Stats</span>
            </div>
            <div class="usage-content">
              <div class="usage-card">
                <h3>Total Snips</h3>
                <p id="stats-total-snips">0</p>
              </div>
              <div class="usage-card">
                <h3>Total Chat Messages</h3>
                <p id="stats-total-messages">0</p>
              </div>
              <div class="usage-card">
                <h3>Most Active Character</h3>
                <p id="stats-top-character">‚Äì</p>
              </div>
              <div class="usage-card">
                <h3>Last Used</h3>
                <p id="stats-last-used">‚Äì</p>
              </div>
            </div>
          </div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SETTINGS SECTION (placeholder) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <section
          id="settings-section"
          class="content-section hidden"
          aria-label="Settings"
        >
          <h2>Settings panel coming soon!</h2>
          <div class="appearance-section">
            <h3>Appearance</h3>
            <div class="setting-item">
              <label class="toggle-label" for="toggle-theme"
                >üåó Dark Mode:</label
              >
              <input id="toggle-theme" class="toggle-input" type="checkbox" />
              <span class="custom-slider"></span>
            </div>
          </div>
        </section>

        <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ MAIN CHAT PANEL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
        <main
          id="main-content"
          role="main"
          aria-live="polite"
          aria-relevant="additions removals"
          tabindex="0"
        >
          <div class="chat-panel" aria-label="Active chat panel">
            <div class="chat-header" aria-label="Chat header" role="banner">
              <img
                class="chat-avatar"
                alt="Agent avatar"
                id="chat-agent-avatar"
                src="avatars/white.png"
              />
              <span id="chat-agent-name" class="chat-agent-name"
                >Select an agent</span
              >
            </div>

            <!-- MAIN CHAT HISTORY -->
            <div
              id="chat-history"
              class="chat-history"
              aria-live="polite"
              aria-atomic="false"
              tabindex="0"
            ></div>

            <!-- TOOLBAR -->
            <div class="chat-toolbar" role="region" aria-label="Chat toolbar">
              <button
                id="toolbar-attach-btn"
                aria-label="Attach files"
                title="Attach files"
                type="button"
              >
                üìé
              </button>
              <button
                id="toolbar-regenerate-btn"
                aria-label="Regenerate response"
                title="Regenerate response"
                type="button"
              >
                ‚ü≥
              </button>

              <!-- AGENT THREAD BAR (used by popup.js) -->
              <div
                id="agent-thread-section"
                class="thread-section"
                style="margin-bottom: 12px"
              >
                <div class="thread-header">
                  <span>Threads</span>
                  <button
                    id="new-thread-btn"
                    title="Create new thread"
                    type="button"
                  >
                    +
                  </button>
                </div>
                <ul
                  id="thread-list"
                  class="thread-list"
                  style="
                    max-height: 150px;
                    overflow-y: auto;
                    padding: 0;
                    margin: 0;
                  "
                ></ul>
              </div>
            </div>

            <!-- ATTACHMENT PREVIEW BAR -->
            <div
              id="attachment-preview"
              aria-live="polite"
              aria-atomic="true"
            ></div>

            <!-- CHAT INPUT -->
            <div class="chat-input-row">
              <div class="chat-input-group">
                <textarea
                  id="chat-input"
                  autocomplete="off"
                  placeholder="Ask or enter a prompt"
                  rows="1"
                  aria-multiline="true"
                  spellcheck="false"
                  aria-label="Chat input"
                ></textarea>
                <button
                  id="chat-send-btn"
                  aria-label="Send message"
                  type="button"
                >
                  Send
                </button>
              </div>
            </div>
          </div>

          <!-- ATTACHMENT MODAL -->
          <div
            id="attachment-modal"
            class="attachment-modal"
            role="dialog"
            aria-modal="true"
            aria-hidden="true"
            tabindex="-1"
            aria-label="Attachment preview modal"
          >
            <button
              id="attachment-modal-close"
              aria-label="Close attachment preview"
              title="Close"
              type="button"
            >
              √ó
            </button>
            <img id="attachment-modal-img" alt="Attachment preview" />
          </div>
        </main>
      </div>

      <!-- OVERLAY + SIDEBAR TOGGLE -->
      <div id="main-content-overlay" tabindex="-1"></div>
      <button
        id="sidebar-toggle"
        aria-label="Toggle sidebar"
        title="Toggle sidebar"
        type="button"
      >
        ‚ò∞
      </button>
    </div>

    <script src="popup.js"></script>
  </body>
</html>
